{"version":3,"sources":["utils/list-items.js","components/status-buttons.js","components/rating.js","components/book-row.js","components/list-item-list.js","screens/reading-list.js","screens/finished.js","screens/discover.js","utils/misc.js","screens/book.js","screens/not-found.js","authenticated-app.js"],"names":["useListItem","bookId","options","listItems","useListItems","find","li","client","useClient","useQuery","queryKey","queryFn","then","data","config","onSuccess","a","listItem","setQueryDataForBook","book","defaultMutationOptions","onError","err","variables","recover","onSettled","queryCache","invalidateQueries","onUpdateMutation","newItem","previousItems","getQueryData","setQueryData","old","map","item","id","useUpdateListItem","useMutation","updates","method","onMutate","TooltipButton","label","onClick","highlight","icon","rest","useAsync","isLoading","isError","error","run","reset","message","className","disabled","handleClick","StatusButtons","throwOnError","mutate","useRemoveListItem","removedItem","filter","handleRemoveClick","useCreateListItem","handleAddClick","Boolean","finishDate","Date","now","visuallyHiddenCSS","Rating","React","setIsTabbing","handleKeyDown","event","key","document","addEventListener","once","removeEventListener","rootClassName","stars","Array","from","length","x","i","ratingId","ratingValue","name","type","value","checked","rating","onChange","htmlFor","e","stopPropagation","BookRow","title","author","coverImageUrl","to","src","alt","publisher","synopsis","substring","ListItemList","filterListItems","noListItems","noFilteredListItems","filteredListItems","ReadingListScreen","FinishedScreen","DiscoverBooksScreen","query","setQuery","queried","setQueried","useBookSearch","books","isSuccess","refetchBookSearchQuery","useRefetchBookSearchQuery","onSubmit","handleSearchClick","preventDefault","target","elements","search","placeholder","formatDate","date","Intl","DateTimeFormat","month","year","format","BookScreen","useParams","useBook","loadingBook","ListItemTimeframe","NotesTextarea","timeframeLabel","startDate","debouncedMutate","debounceFn","wait","variant","defaultValue","notes","handleNotesChange","NotFoundScreen","classNanw","ErrorFallback","NavLink","props","Nav","params","AppRoutes","path","element","AuthenticatedApp","useAuth","user","logout","FallbackComponent","FullPageErrorFallback","username"],"mappings":"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","file":"static/js/5.2ce108ee.chunk.js","sourcesContent":["import {useQuery, useMutation, queryCache} from 'react-query'\nimport {setQueryDataForBook} from './books'\nimport {useClient} from 'context/auth-context'\n\nfunction useListItem(bookId, options) {\n  const listItems = useListItems(options)\n  return listItems?.find(li => li.bookId === bookId) ?? null\n}\n\nfunction useListItems(options = {}) {\n  const client = useClient()\n\n  const {data: listItems} = useQuery({\n    queryKey: 'list-items',\n    queryFn: () => client('list-items').then(data => data.listItems),\n    ...options,\n    config: {\n      ...options.config,\n      onSuccess: async listItems => {\n        await options.config?.onSuccess?.(listItems)\n        for (const listItem of listItems) {\n          setQueryDataForBook(listItem.book)\n        }\n      },\n    },\n  })\n  return listItems ?? []\n}\n\nconst defaultMutationOptions = {\n  onError: (err, variables, recover) =>\n    typeof recover === 'function' ? recover() : null,\n  onSettled: () => queryCache.invalidateQueries('list-items'),\n}\n\nfunction onUpdateMutation(newItem) {\n  const previousItems = queryCache.getQueryData('list-items')\n\n  queryCache.setQueryData('list-items', old => {\n    return old.map(item => {\n      return item.id === newItem.id ? {...item, ...newItem} : item\n    })\n  })\n\n  return () => queryCache.setQueryData('list-items', previousItems)\n}\n\nfunction useUpdateListItem(options) {\n  const client = useClient()\n\n  return useMutation(\n    updates =>\n      client(`list-items/${updates.id}`, {\n        method: 'PUT',\n        data: updates,\n      }),\n    {\n      onMutate: onUpdateMutation,\n      ...defaultMutationOptions,\n      ...options,\n    },\n  )\n}\n\nfunction useRemoveListItem(options) {\n  const client = useClient()\n\n  return useMutation(({id}) => client(`list-items/${id}`, {method: 'DELETE'}), {\n    onMutate: removedItem => {\n      const previousItems = queryCache.getQueryData('list-items')\n\n      queryCache.setQueryData('list-items', old => {\n        return old.filter(item => item.id !== removedItem.id)\n      })\n\n      return () => queryCache.setQueryData('list-items', previousItems)\n    },\n    ...defaultMutationOptions,\n    ...options,\n  })\n}\n\nfunction useCreateListItem(options) {\n  const client = useClient()\n\n  return useMutation(({bookId}) => client('list-items', {data: {bookId}}), {\n    ...defaultMutationOptions,\n    ...options,\n  })\n}\n\nexport {\n  useListItem,\n  useListItems,\n  useUpdateListItem,\n  useRemoveListItem,\n  useCreateListItem,\n}\n","import * as React from 'react'\nimport {\n  FaCheckCircle,\n  FaPlusCircle,\n  FaMinusCircle,\n  FaBook,\n  FaTimesCircle,\n} from 'react-icons/fa'\nimport {\n  useListItem,\n  useUpdateListItem,\n  useRemoveListItem,\n  useCreateListItem,\n} from 'utils/list-items'\nimport {useAsync} from 'utils/hooks'\nimport {CircleButton, Spinner} from './lib'\n\nfunction TooltipButton({label, highlight, onClick, icon, ...rest}) {\n  const {isLoading, isError, error, run, reset} = useAsync()\n\n  function handleClick() {\n    if (isError) {\n      reset()\n    } else {\n      run(onClick())\n    }\n  }\n\n  return (\n    <div label={isError ? error.message : label}>\n      <CircleButton\n        className=\"bg-white hover:text-gray focus:text-gray\"\n        disabled={isLoading}\n        onClick={handleClick}\n        aria-label={isError ? error.message : label}\n        {...rest}\n      >\n        {isLoading ? <Spinner /> : isError ? <FaTimesCircle /> : icon}\n      </CircleButton>\n    </div>\n  )\n}\n\nfunction StatusButtons({book}) {\n  const listItem = useListItem(book.id)\n\n  const [mutate] = useUpdateListItem({throwOnError: true})\n  const [handleRemoveClick] = useRemoveListItem({throwOnError: true})\n  const [handleAddClick] = useCreateListItem({throwOnError: true})\n\n  return (\n    <React.Fragment>\n      {listItem ? (\n        Boolean(listItem.finishDate) ? (\n          <TooltipButton\n            label=\"Mark as unread\"\n            className=\"text-yellow\"\n            onClick={() => mutate({id: listItem.id, finishDate: null})}\n            icon={<FaBook />}\n          />\n        ) : (\n          <TooltipButton\n            label=\"Mark as read\"\n            className=\"text-green\"\n            onClick={() => mutate({id: listItem.id, finishDate: Date.now()})}\n            icon={<FaCheckCircle />}\n          />\n        )\n      ) : null}\n      {listItem ? (\n        <TooltipButton\n          label=\"Remove from list\"\n          className=\"text-red\"\n          onClick={() => handleRemoveClick({id: listItem.id})}\n          icon={<FaMinusCircle />}\n        />\n      ) : (\n        <TooltipButton\n          label=\"Add to list\"\n          className=\"text-indigo\"\n          onClick={() => handleAddClick({bookId: book.id})}\n          icon={<FaPlusCircle />}\n        />\n      )}\n    </React.Fragment>\n  )\n}\n\nexport {StatusButtons}\n","\nimport * as React from 'react'\nimport {useUpdateListItem} from 'utils/list-items'\nimport {FaStar} from 'react-icons/fa'\nimport {ErrorMessage} from 'components/lib'\n\nconst visuallyHiddenCSS = \"b-0 h-1 -m-1 overflow-hidden p-0 bg-clip-content absolute w-1\"\n\nfunction Rating({listItem}) {\n  const [isTabbing, setIsTabbing] = React.useState(false)\n\n  const [mutate, {error, isError}] = useUpdateListItem()\n\n  React.useEffect(() => {\n    function handleKeyDown(event) {\n      if (event.key === 'Tab') {\n        setIsTabbing(true)\n      }\n    }\n    document.addEventListener('keydown', handleKeyDown, {once: true})\n    return () => document.removeEventListener('keydown', handleKeyDown)\n  }, [])\n\n  const rootClassName = `list-item-${listItem.id}`\n\n  const stars = Array.from({length: 5}).map((x, i) => {\n    const ratingId = `rating-${listItem.id}-${i}`\n    const ratingValue = i + 1\n    return (\n      <React.Fragment key={i}>\n        <input\n          name={rootClassName}\n          type=\"radio\"\n          id={ratingId}\n          value={ratingValue}\n          checked={ratingValue === listItem.rating}\n          onChange={() => {\n            mutate({id: listItem.id, rating: ratingValue})\n          }}\n          className={visuallyHiddenCSS}\n        />\n        <label\n          htmlFor={ratingId}\n          className=\"cursor-pointer text-gray-500 m-0\"\n        >\n          <span className={visuallyHiddenCSS}>\n            {ratingValue} {ratingValue === 1 ? 'star' : 'stars'}\n          </span>\n          <FaStar className=\"w-4 mt-0 mr-2\" />\n        </label>\n      </React.Fragment>\n    )\n  })\n  return (\n    <div\n      onClick={e => e.stopPropagation()}\n      className={rootClassName}\n    >\n      <span className=\"flex\">{stars}</span>\n      {isError ? (\n        <ErrorMessage\n          error={error}\n          className=\"inline ml-6 font-0.5\"\n        />\n      ) : null}\n    </div>\n  )\n}\n\nexport {Rating}\n","import React from 'react'\nimport {Link} from 'react-router-dom'\nimport {useListItem} from 'utils/list-items'\nimport {StatusButtons} from './status-buttons'\nimport {Rating} from './rating'\n\nfunction BookRow({book}) {\n  const {title, author, coverImageUrl} = book\n  const listItem = useListItem(book.id)\n\n  const id = `book-row-book-${book.id}`\n\n  return (\n    <div\n      className=\"flex items-center relative content-end\"\n    >\n      <Link\n        aria-labelledby={id}\n        to={`/book/${book.id}`}\n        className=\"min-h-270 flex-grow grid auto-cols-max gap-2 border-solid border-gray-200 text-black p-1.5 rounder-3 focus:hover:no-underline \"\n      >\n        <div\n          className=\"w-140 md:w-100\"\n        >\n          <img\n            src={coverImageUrl}\n            alt={`${title} book cover`}\n            className=\"max-h-full w-full\"\n          />\n        </div>\n        <div className=\"flex-1\">\n          <div className=\"flex justify-between\">\n            <div className=\"flex-1\">\n              <h2\n                id={id}\n                className=\"text-lg m-0 text-indigo-300\"\n              >\n                {title}\n              </h2>\n              {listItem?.finishDate ? <Rating listItem={listItem} /> : null}\n            </div>\n            <div className=\"ml-2.5\">\n              <div className=\"mt-0.2 italic text-sm\">\n                {author}\n              </div>\n              <small>{book.publisher}</small>\n            </div>\n          </div>\n          <small className=\"whitespace-pre-wrap block\">\n            {book.synopsis.substring(0, 500)}...\n          </small>\n        </div>\n      </Link>\n      <div className=\"ml-8 absolute -right-20 text-gray-500 flex flex-col justify-around h-full\">\n        <StatusButtons book={book} />\n      </div>\n    </div>\n  )\n}\n\nexport {BookRow}\n","import React from 'react'\nimport {useListItems} from 'utils/list-items'\nimport {BookListUL} from './lib'\nimport {BookRow} from './book-row'\n// import {Profiler} from './profiler'\n\nfunction ListItemList({filterListItems, noListItems, noFilteredListItems}) {\n  const listItems = useListItems()\n\n  const filteredListItems = listItems.filter(filterListItems)\n\n  if (!listItems.length) {\n    return <div  className=\"mt-1 font-1.2\">{noListItems}</div>\n  }\n  if (!filteredListItems.length) {\n    return (\n      <div className=\"mt-1 font-1.2\">\n        {noFilteredListItems}\n      </div>\n    )\n  }\n\n  return (\n      <BookListUL>\n        {filteredListItems.map(listItem => (\n          <li key={listItem.id} aria-label={listItem.book.title}>\n            <BookRow book={listItem.book} />\n          </li>\n        ))}\n      </BookListUL>\n  )\n}\n\nexport {ListItemList}\n","import * as React from 'react'\nimport {Link} from 'components/lib'\nimport {ListItemList} from 'components/list-item-list'\n\nfunction ReadingListScreen() {\n  return (\n    <ListItemList\n      filterListItems={li => !li.finishDate}\n      noListItems={\n        <p>\n          Hey there! Welcome to your bookshelf reading list. Get started by\n          heading over to <Link to=\"/discover\">the Discover page</Link> to add\n          books to your list.\n        </p>\n      }\n      noFilteredListItems={\n        <p>\n          Looks like you've finished all your books! Check them out in your{' '}\n          <Link to=\"/finished\">finished books</Link> or{' '}\n          <Link to=\"/discover\">discover more</Link>.\n        </p>\n      }\n    />\n  )\n}\n\nexport {ReadingListScreen}\n","import * as React from 'react'\nimport {Link} from 'components/lib'\nimport {ListItemList} from 'components/list-item-list'\n\nfunction FinishedScreen() {\n  return (\n    <ListItemList\n      filterListItems={li => Boolean(li.finishDate)}\n      noListItems={\n        <p>\n          Hey there! This is where books will go when you've finished reading\n          them. Get started by heading over to{' '}\n          <Link to=\"/discover\">the Discover page</Link> to add books to your\n          list.\n        </p>\n      }\n      noFilteredListItems={\n        <p>\n          Looks like you've got some reading to do! Check them out in your{' '}\n          <Link to=\"/list\">reading list</Link> or{' '}\n          <Link to=\"/discover\">discover more</Link>.\n        </p>\n      }\n    />\n  )\n}\n\nexport {FinishedScreen}\n","import * as React from 'react'\nimport Tooltip from '@reach/tooltip'\nimport {FaSearch, FaTimes} from 'react-icons/fa'\nimport {useBookSearch, useRefetchBookSearchQuery} from 'utils/books'\nimport {BookRow} from 'components/book-row'\nimport {BookListUL, Spinner, Input} from 'components/lib'\n\nfunction DiscoverBooksScreen() {\n  const [query, setQuery] = React.useState('')\n  const [queried, setQueried] = React.useState()\n  const {books, error, isLoading, isError, isSuccess} = useBookSearch(query)\n  const refetchBookSearchQuery = useRefetchBookSearchQuery()\n\n  React.useEffect(() => {\n    return () => refetchBookSearchQuery()\n  }, [refetchBookSearchQuery])\n\n  function handleSearchClick(event) {\n    event.preventDefault()\n    setQueried(true)\n    setQuery(event.target.elements.search.value)\n  }\n\n  return (\n    <div>\n      <div>\n        <form onSubmit={handleSearchClick}>\n          <Input\n            placeholder=\"Search books...\"\n            id=\"search\"\n            type=\"search\"\n            className=\"w-full\"\n          />\n          <Tooltip label=\"Search Books\">\n            <label htmlFor=\"search\">\n              <button\n                type=\"submit\"\n                className=\"b-0 relative -ml-35 bg-transparent\"\n              >\n                {isLoading ? (\n                  <Spinner />\n                ) : isError ? (\n                  <FaTimes aria-label=\"error\" className=\"text-red\" />\n                ) : (\n                  <FaSearch aria-label=\"search\" />\n                )}\n              </button>\n            </label>\n          </Tooltip>\n        </form>\n\n        {isError ? (\n          <div className=\"text-red\">\n            <p>There was an error:</p>\n            <pre>{error.message}</pre>\n          </div>\n        ) : null}\n      </div>\n      <div>\n        {queried ? null : (\n          <div className=\"mt-20 text-base text-center\">\n            <p>Welcome to the discover page.</p>\n            <p>Here, let me load a few books for you...</p>\n            {isLoading ? (\n              <div className=\"w-full m-auto\">\n                <Spinner />\n              </div>\n            ) : isSuccess && books.length ? (\n              <p>Here you go! Find more books with the search bar above.</p>\n            ) : isSuccess && !books.length ? (\n              <p>\n                Hmmm... I couldn't find any books to suggest for you. Sorry.\n              </p>\n            ) : null}\n          </div>\n        )}\n        {books.length ? (\n            <BookListUL className=\"mt-20\">\n              {books.map(book => (\n                <li key={book.id} aria-label={book.title}>\n                  <BookRow key={book.id} book={book} />\n                </li>\n              ))}\n            </BookListUL>\n        ) : queried ? (\n          <div className=\"mt-20 text-lg text-center\">\n            {isLoading ? (\n              <div className=\"w-full m-auto\">\n                <Spinner />\n              </div>\n            ) : (\n              <p>\n                Hmmm... I couldn't find any books with the query \"{query}.\"\n                Please try another.\n              </p>\n            )}\n          </div>\n        ) : null}\n      </div>\n    </div>\n  )\n}\n\nexport {DiscoverBooksScreen}\n","const formatDate = date =>\n  new Intl.DateTimeFormat('en-US', {month: 'short', year: '2-digit'}).format(\n    date,\n  )\n\nexport {formatDate}\n","\nimport * as React from 'react'\nimport debounceFn from 'debounce-fn'\nimport {FaRegCalendarAlt} from 'react-icons/fa'\nimport Tooltip from '@reach/tooltip'\nimport {useParams} from 'react-router-dom'\nimport {useBook} from 'utils/books'\nimport {formatDate} from 'utils/misc'\nimport {useListItem, useUpdateListItem} from 'utils/list-items'\nimport {Spinner, Textarea, ErrorMessage} from 'components/lib'\nimport {Rating} from 'components/rating'\n// import {Profiler} from 'components/profiler'\nimport {StatusButtons} from 'components/status-buttons'\n\nfunction BookScreen() {\n  const {bookId} = useParams()\n  const book = useBook(bookId)\n  const listItem = useListItem(bookId)\n\n  const {title, author, coverImageUrl, publisher, synopsis} = book\n\n  return (\n      <div>\n        <div\n          className=\"grid mb-1 grid-cols-book gap-x-1.5 md:flex md:flex-col\"\n        >\n          <img\n            src={coverImageUrl}\n            alt={`${title} book cover`}\n            className=\"w-full max-w-xs\"\n          />\n          <div>\n            <div className=\"flex relative\">\n              <div className=\"flex-1 justify-between\">\n                <h1>{title}</h1>\n                <div>\n                  <i>{author}</i>\n                  <span className=\"mr-6 ml-6\">|</span>\n                  <i>{publisher}</i>\n                </div>\n              </div>\n              <div\n                className=\"r-0 text-gray flex flex-col justify-around min-q-full\"\n              >\n                {book.loadingBook ? null : <StatusButtons book={book} />}\n              </div>\n            </div>\n            <div className=\"mt-10 min-h-min\">\n              {listItem?.finishDate ? <Rating listItem={listItem} /> : null}\n              {listItem ? <ListItemTimeframe listItem={listItem} /> : null}\n            </div>\n            <br />\n            <p className=\"block whitespace-pre-wrap\">\n              {synopsis}\n            </p>\n          </div>\n        </div>\n        {!book.loadingBook && listItem ? (\n          <NotesTextarea listItem={listItem} />\n        ) : null}\n      </div>\n  )\n}\n\nfunction ListItemTimeframe({listItem}) {\n  const timeframeLabel = listItem.finishDate\n    ? 'Start and finish date'\n    : 'Start date'\n\n  return (\n    <Tooltip label={timeframeLabel}>\n      <div aria-label={timeframeLabel} className=\"mt-5\">\n        <FaRegCalendarAlt className=\"-mt-2 mr-5\" />\n        <span>\n          {formatDate(listItem.startDate)}{' '}\n          {listItem.finishDate ? `— ${formatDate(listItem.finishDate)}` : null}\n        </span>\n      </div>\n    </Tooltip>\n  )\n}\n\nfunction NotesTextarea({listItem}) {\n  const [mutate, {error, isError, isLoading}] = useUpdateListItem()\n\n  const debouncedMutate = React.useMemo(\n    () => debounceFn(mutate, {wait: 500}),\n    [mutate],\n  )\n\n  function handleNotesChange(e) {\n    debouncedMutate({id: listItem.id, notes: e.target.value})\n  }\n\n  return (\n    <React.Fragment>\n      <div>\n        <label\n          htmlFor=\"notes\"\n          className=\"inline-block mr-10 mt-0 mb-0.5 font-bold\"\n        >\n          Notes\n        </label>\n        {isError ? (\n          <ErrorMessage\n            variant=\"inline\"\n            error={error}\n            className=\"font-0.5\"\n          />\n        ) : null}\n        {isLoading ? <Spinner /> : null}\n      </div>\n      <Textarea\n        id=\"notes\"\n        defaultValue={listItem.notes}\n        onChange={handleNotesChange}\n        className=\"w-full min-h-300\"\n      />\n    </React.Fragment>\n  )\n}\n\nexport {BookScreen}\n","import React from 'react'\nimport {Link} from 'components/lib'\n\nfunction NotFoundScreen() {\n  return (\n    <div\n      classNanw=\"h-full grid items-center justify-center\"\n    >\n      <div>\n        Sorry... nothing here. <Link to=\"/list\">Go home</Link>\n      </div>\n    </div>\n  )\n}\n\nexport {NotFoundScreen}\n","// , useMatch\nimport React from 'react'\nimport {Routes, Route, Link as RouterLink} from 'react-router-dom'\nimport {ErrorBoundary} from 'react-error-boundary'\nimport {Button, ErrorMessage, FullPageErrorFallback} from './components/lib'\nimport {useAuth} from './context/auth-context'\nimport {ReadingListScreen} from './screens/reading-list'\nimport {FinishedScreen} from './screens/finished'\nimport {DiscoverBooksScreen} from './screens/discover'\nimport {BookScreen} from './screens/book'\nimport {NotFoundScreen} from './screens/not-found'\n\nfunction ErrorFallback({error}) {\n  return (\n    <ErrorMessage\n      error={error}\n      className=\"h-full flex flex-col content-center items-center\"\n    />\n  )\n}\n\nfunction AuthenticatedApp() {\n  const {user, logout} = useAuth()\n  return (\n    <ErrorBoundary FallbackComponent={FullPageErrorFallback}>\n      <div\n        className=\"flex items-center absolute inset-t-4 inset-r-4\"\n      >\n        {user.username}\n        <Button variant=\"secondary\" className=\"ml-2.5\" onClick={logout}>\n          Logout\n        </Button>\n      </div>\n      <div\n        className=\"m-0 pt-2 pt-1 max-w-10 w-full grid gap-1 grid-cols-3 md:grid-cols-1 md:w-full md:grid-rows-6 ...\"\n      >\n        <div className=\"relative\">\n          <Nav />\n        </div>\n        <main className=\"w-full\">\n          <ErrorBoundary FallbackComponent={ErrorFallback}>\n            <AppRoutes />\n          </ErrorBoundary>\n        </main>\n      </div>\n    </ErrorBoundary>\n  )\n}\n\nfunction NavLink(props) {\n  // const match = useMatch(props.to)\n  return (\n    <RouterLink\n      className=\"block p-2 mt-1 w-full h-full text-black rounder-1 border-r-2 border-solid border-transparent hover:text-gray hover:text-none hover:bg-indigo-500\"\n      {...props}\n    />\n  )\n}\n\nfunction Nav(params) {\n  return (\n    <nav\n      className=\"sticky inset-t-4 pt-1 pr-1.5 border border-solid border-gray-50 md:static md:inset-t\"\n    >\n      <ul\n        className=\"list-none p-0\"\n      >\n        <li>\n          <NavLink to=\"/list\">Reading List</NavLink>\n        </li>\n        <li>\n          <NavLink to=\"/finished\">Finished Books</NavLink>\n        </li>\n        <li>\n          <NavLink to=\"/discover\">Discover</NavLink>\n        </li>\n      </ul>\n    </nav>\n  )\n}\n\nfunction AppRoutes() {\n  return (\n    <Routes>\n      <Route path=\"/list\" element={<ReadingListScreen />} />\n      <Route path=\"/finished\" element={<FinishedScreen />} />\n      <Route path=\"/discover\" element={<DiscoverBooksScreen />} />\n      <Route path=\"/book/:bookId\" element={<BookScreen />} />\n      <Route path=\"*\" element={<NotFoundScreen />} />\n    </Routes>\n  )\n}\n\nexport default AuthenticatedApp\n"],"sourceRoot":""}